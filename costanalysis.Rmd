---
title: "Check out this sick analysis"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(readr)
```


```{r upload files}
data_ad_time <- read_csv("~/STA 518/Final Project/Portfolio/Final Proposal/Final Project/Ad  Time _ Category - Sheet1.csv")
data <- read_csv("~/STA 518/Final Project/Portfolio/Final Proposal/Final Project/combined  - Sheet1.csv")
data_ad_cost <- read_csv("~/STA 518/Final Project/Portfolio/Final Proposal/Final Project/Cost per Super bowl ad 2000-2020 - Sheet1 (1).csv")
```
```{r joining two data sets }
# merge data and data_ad_cost together 
total <- inner_join(data, data_ad_cost, by="year")
total
dim(total)
#chr to Numeric cost_per_minute and cost_per_thirty_seconds
total11<-
total%>% as.data.frame %>%
  mutate(cost_per_minute=str_remove_all(cost_per_minute,"[$,]"),
         cost_per_minute=as.numeric(cost_per_minute)) %>%
  mutate(cost_per_thirty_seconds=str_remove_all(cost_per_thirty_seconds,"[$,]"),
        cost_per_thirty_seconds=as.numeric(cost_per_thirty_seconds))%>%
  
  mutate(cost_per_second = cost_per_minute/60 )%>%
  
  mutate(cost_of_ad= cost_per_second*ad_time) %>%
  mutate(cost_of_ad_in_millions =cost_of_ad/1000000 )%>%
  mutate(cost_per_second_in_thousands =cost_per_second/100000)
  
total11
 # mutate(currency = scales::dollar(cost_per_second))

## Including Plots

```{r pressure, echo=FALSE}
ggplot(data=total11, aes(x=year, y=cost_per_second_in_thousands)) +
  geom_line(linetype = "dashed", color="blue", size=1)+
    theme(legend.position="bottom")+
  geom_point(color="blue")+
  ggtitle("Cost Per Second of Super Bowl Ads from 2000 to 2020")+
    ylab("Cost (Hundreds of Thousands of Dollars)")
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
